<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>–ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ –Ω–∞ –¥–µ–Ω—å —Ä–æ–∂–¥–µ–Ω–∏—è</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div class="background">
    <!-- üîπ –í–µ—Ä—Ö–Ω—è—è –ø–∞–Ω–µ–ª—å -->
    <header class="header">
        <div class="nav">
          <div class="nav-side nav-left">
            <a href="#" class="nav-item">—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</a>
          </div>
      
          <div class="nav-center">
            <img src="img/flower2.png" alt="–¶–≤–µ—Ç–æ–∫" class="flower">
          </div>
      
          <div class="nav-side nav-right">
            <a href="#" class="nav-item">–ø–æ–¥–∞—Ä–∫–∏</a>
          </div>
        </div>
      </header>
      

    <section class="hero">
        <!-- –õ–ï–í–ê–Ø –ü–ê–†–ê –§–û–ù–ê–†–ï–ô -->
        <div class="lanterns left">
          <!-- –ó–ê–î–ù–ò–ô —Ñ–æ–Ω–∞—Ä—å ‚Äî —Å—Ç–∞—Ä–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ -->
          <img src="img/flashlight.png" alt="—Ñ–æ–Ω–∞—Ä—å" class="lantern back">
      
          <!-- –ü–ï–†–ï–î–ù–ò–ô —Ñ–æ–Ω–∞—Ä—å ‚Äî –Ω–æ–≤–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å –¥–ª–∏–Ω–Ω–æ–π –≤–µ—Ä—ë–≤–∫–æ–π -->
          <div class="lantern-long front">
            <img src="img/flashlight2.png" alt="—Ñ–æ–Ω–∞—Ä—å —Å –¥–ª–∏–Ω–Ω–æ–π –≤–µ—Ä—ë–≤–∫–æ–π">
          </div>
        </div>
      
        <!-- –ü–†–ê–í–ê–Ø –ü–ê–†–ê –§–û–ù–ê–†–ï–ô -->
        <div class="lanterns right">
          <img src="img/flashlight.png" alt="—Ñ–æ–Ω–∞—Ä—å" class="lantern back">
      
          <div class="lantern-long front">
            <img src="img/flashlight2.png" alt="—Ñ–æ–Ω–∞—Ä—å —Å –¥–ª–∏–Ω–Ω–æ–π –≤–µ—Ä—ë–≤–∫–æ–π">
          </div>
        </div>
      
        <img src="img/Chinese_inscription.png" alt="–ù–∞–¥–ø–∏—Å—å" class="inscription">
        <h1>–ü–†–ò–ì–õ–ê–®–ï–ù–ò–ï –ù–ê –î–ï–ù–¨ –†–û–ñ–î–ï–ù–ò–Ø</h1>
      </section>
      
      <section class="event-info">
        <div class="info-card">
          <img src="img/2.1.png" alt="—Ñ–æ–Ω —Å –ø–∞–Ω–¥–∞–º–∏" class="info-img">
          <div class="info-text">
            <p><strong>–î–∞—Ç–∞:</strong> 30 –Ω–æ—è–±—Ä—è 2025 –≥.</p>
            <p><strong>–í—Ä–µ–º—è:</strong> 16:00</p>
            <p><strong>–ú–µ—Å—Ç–æ:</strong> –†–µ—Å—Ç–æ—Ä–∞–Ω "–î–æ–Ω –§–∞–Ω" —É–ª. –†–∞–¥–∏—â–µ–≤–∞, 25</p>
          </div>
        </div>
      </section>
      
      
      <section class="rsvp-section">
        <div class="rsvp-card">
          <img src="img/1.3.png" alt="—Ñ–æ–Ω —Å –±–∞–º–±—É–∫–æ–º" class="rsvp-img">
      
          <form class="rsvp-form">
            <!-- 1. –ò–º—è / —Ñ–∞–º–∏–ª–∏—è -->
            <div class="rsvp-row">
              <input
  type="text"
  class="rsvp-input"
  id="full_name"
  name="full_name"
  placeholder="–í–∞—à–µ –∏–º—è  /  –§–∞–º–∏–ª–∏—è"
  autocomplete="name"
  required
/>

            </div>
      
            <!-- 2. –ü–æ–π–¥—ë—Ç–µ? –¥–∞ / –Ω–µ—Ç -->
            <div class="rsvp-row rsvp-row-inline">
              <span class="rsvp-label">–ü–æ–π–¥—ë—Ç–µ? </span>
      
              <div class="rsvp-radio-group">
                <input type="radio" id="go-yes" name="go" value="yes" checked>
                <label for="go-yes">–¥–∞</label>
      
                <span class="rsvp-slash">/</span>
      
                <input type="radio" id="go-no" name="go" value="no">
                <label for="go-no">–Ω–µ—Ç</label>
              </div>
            </div>
      

            <!-- 3. –ö–Ω–æ–ø–∫–∞ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å + –ø–æ–¥–ø–∏—Å—å -->
            <div class="rsvp-row rsvp-row-inline rsvp-submit-row">
                <button type="submit" class="rsvp-submit">
                    –æ—Ç–ø—Ä–∞–≤–∏—Ç—å
                </button>
                <span class="rsvp-deadline">–æ—Ç–≤–µ—Ç–∏—Ç—å –¥–æ 25.11.2025</span>
            </div>
  
          </form>
        </div>
      </section>
      

    <!-- üîπ –ü–æ–¥–∞—Ä–∫–∏ –∏ –≤–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏–µ -->
<section class="gifts">
    <h2 class="gifts-title">–ü–û–î–ê–†–ö–ò –ò –í–î–û–•–ù–û–í–ï–ù–ò–ï</h2>
  
    <div class="gifts-grid">
      <!-- –∫–∞—Ä—Ç–æ—á–∫–∞ 1 -->
      <a href="https://docs.google.com/document/d/13-m_k3O88hK18vilrefshgFj-pgBFwkCEOnLMYhdfnQ/edit"
         class="gift-card" target="_blank" rel="noopener">
        <img src="img/image1.png" alt="Wishlist 1 ‚Äî Google" class="gift-img">
      </a>
  
      <!-- –∫–∞—Ä—Ç–æ—á–∫–∞ 2 -->
      <a href="https://ohmywishes.ru/users/bc64fb2df839edd614718429"
         class="gift-card" target="_blank" rel="noopener">
        <img src="img/image2.png" alt="Wishlist 2 ‚Äî OhMyWishes" class="gift-img">
      </a>
  
      <!-- –∫–∞—Ä—Ç–æ—á–∫–∞ 3 -->
      <a href="https://pin.it/2UCNRshI4"
         class="gift-card" target="_blank" rel="noopener">
        <img src="img/image3.png" alt="Mood board Pinterest" class="gift-img">
      </a>
    </div>
  </section>  
  </div>


  <script>
    // ===== –ì–õ–û–ë–ê–õ–¨–ù–û: id –ø–æ—Å–ª–µ–¥–Ω–µ–π –∑–∞–ø–∏—Å–∏ –≤ —Ç–∞–±–ª–∏—Ü–µ rsvp =====
    let lastRsvpId = null;
  
    // --- –†–∞–∑–±–∏–≤–∞–µ–º –æ–¥–Ω—É —Å—Ç—Ä–æ–∫—É "–ò–º—è –§–∞–º–∏–ª–∏—è" –Ω–∞ name / surname ---
    function splitName(full) {
      const parts = full.trim().split(/\s+/).filter(Boolean);
      if (parts.length === 0) return { name: "", surname: "" };
  
      const surname = parts.length > 1 ? parts.pop() : "";
      const name = parts.join(" ");
  
      // –ü–æ–¥—Å—Ç—Ä–∞—Ö—É–µ–º—Å—è, —Ç.–∫. surname –≤ –±–∞–∑–µ NOT NULL
      const fallback = full.trim();
      return {
        name: name || fallback,
        surname: surname || name || fallback
      };
    }
  
    // --- –°–æ—Ö—Ä–∞–Ω—è–µ–º –æ—Å–Ω–æ–≤–Ω–æ–π –æ—Ç–≤–µ—Ç (–∏–¥—ë—Ç / –Ω–µ –∏–¥—ë—Ç) –≤ /api/rsvp ---
    async function saveMainRsvp() {
      const full = document.getElementById('full_name').value;
      const going = document.getElementById('go-yes').checked;
      const { name, surname } = splitName(full);
  
      const res = await fetch('/api/rsvp', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ name, surname, going })
      });
  
      const json = await res.json();
      if (!res.ok || !json.ok) {
        throw new Error(json.error || 'Create failed');
      }
      lastRsvpId = json.rsvp.id;
    }
  
    // --- –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –ø—Ä–æ –ø–ª—é—Å-–æ–¥–Ω–æ–≥–æ –≤ /api/rsvp-plus-one ---
    async function updatePlusOne(id, wants, who) {
      if (!id) return; // –Ω–∞ –≤—Å—è–∫–∏–π —Å–ª—É—á–∞–π
  
      const res = await fetch('/api/rsvp-plus-one', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          id,
          plus_one_wants: wants,
          plus_one_name: who || null
        })
      });
      const json = await res.json();
      if (!res.ok || !json.ok) {
        throw new Error(json.error || 'Update failed');
      }
      return json.rsvp;
    }
  
    // ===== –í—Å–ø–ª—ã–≤–∞—é—â–∏–µ –æ–∫–Ω–∞ =====
  
    function showPopupSequence() {
      createPopup1();
    }
  
    // –ë–∞–∑–æ–≤–∞—è —Ä–∞–∑–º–µ—Ç–∫–∞ –æ–∫–Ω–∞
    function createPopupBase() {
      const overlay = document.createElement("div");
      overlay.className = "popup-overlay";
  
      const box = document.createElement("div");
      box.className = "popup-box";
  
      const bg = document.createElement("img");
      bg.src = "img/pov.png";
      bg.className = "popup-bg";
  
      box.appendChild(bg);
      overlay.appendChild(box);
      document.body.appendChild(overlay);
  
      return { overlay, box };
    }
  
    // 1) –î–∞/–Ω–µ—Ç –ø–æ –ø–ª—é—Å-–æ–¥–Ω–æ–º—É, —Å –ø–∞–Ω–¥–æ–π
    function createPopup1() {
  const { overlay, box } = createPopupBase();

  const title = document.createElement("h3");
  box.appendChild(title);

  // ‚Üê —Å–æ–∑–¥–∞—ë–º –±–µ–ª—É—é –ø–ª–∞—à–∫—É
  const inner = document.createElement("div");
  inner.className = "popup-inner";
  box.appendChild(inner);

  const choice = document.createElement("div");
  choice.className = "popup-choice";

  // radio –∏ –ø–æ–¥–ø–∏—Å–∏
  const rYes = document.createElement("input");
  rYes.type = "radio";
  rYes.name = "plus1";
  rYes.id = "p-yes";

  const rNo  = document.createElement("input");
  rNo.type = "radio";
  rNo.name = "plus1";
  rNo.id = "p-no";

  const labYes = document.createElement("label");
  labYes.className = "popup-half left";
  labYes.htmlFor  = "p-yes";
  labYes.textContent = "–¥–∞";

  const labNo  = document.createElement("label");
  labNo.className  = "popup-half right";
  labNo.htmlFor    = "p-no";
  labNo.textContent = "–Ω–µ—Ç";

  const panda = document.createElement("img");
  panda.src = "img/pand.png";
  panda.className = "popup-panda-bridge";

  choice.append(rYes, rNo, labYes, labNo, panda);
  inner.appendChild(choice);   // –í–ù–£–¢–†–¨ –±–µ–ª–æ–π –ø–ª–∞—à–∫–∏

  // –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏, –∫–∞–∫ —É —Ç–µ–±—è
  labYes.addEventListener("click", () => {
    overlay.remove();
    createPopup2();
  });

  labNo.addEventListener("click", async () => {
    overlay.remove();
    try {
      await updatePlusOne(lastRsvpId, false, null);
    } catch (e) {
      console.error(e);
    }
  });
}

  
function createPopup2() {
  const { overlay, box } = createPopupBase();

  const title = document.createElement("h3");
  box.appendChild(title);

  const inner = document.createElement("div");
  inner.className = "popup-inner";
  box.appendChild(inner);

  const input = document.createElement("input");
  input.type = "text";
  input.placeholder = "–∫–æ–≥–æ?";
  input.className = "popup-input";
  inner.appendChild(input);

  const okBtn = document.createElement("button");
  okBtn.textContent = "–û—Ç–ø—Ä–∞–≤–∏—Ç—å";
  okBtn.className = "popup-ok";
  box.appendChild(okBtn);

  okBtn.addEventListener("click", async () => {
    const who = input.value.trim() || null;
    overlay.remove();

    try {
      await updatePlusOne(lastRsvpId, true, who);
    } catch (e) {
      console.error(e);
    }

    createPopup3("–∑–∞—è–≤–∫–∞ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –Ω–∞ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–∏ —É  –°–∏ –¶–∑–∏–Ω—å–ø–∏–Ω–∞");
  });
}

  
    // 3) –§–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
    function createPopup3(message) {
  const { overlay, box } = createPopupBase();

  const title = document.createElement("h3");
  box.appendChild(title);

  const inner = document.createElement("div");
  inner.className = "popup-inner popup-inner--message";
  box.appendChild(inner);

  const text = document.createElement("p");
  text.className = "popup-message";
  text.textContent = message;
  inner.appendChild(text);

  const ok = document.createElement("button");
  ok.className = "popup-ok";
  ok.textContent = "OK";
  box.appendChild(ok);

  ok.addEventListener("click", () => overlay.remove());
}

  
    // ===== –í—Å—ë –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º, –∫–æ–≥–¥–∞ DOM –≥–æ—Ç–æ–≤ =====
    document.addEventListener("DOMContentLoaded", () => {
      const form = document.querySelector(".rsvp-form");
  
      const regLink = document.querySelector('.nav-left a');
      const giftsLink = document.querySelector('.nav-right a');
      const rsvpSection = document.querySelector('.rsvp-section');
      const giftsSection = document.querySelector('.gifts');
  
      // --- –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ñ–æ—Ä–º—ã ---
      form.addEventListener("submit", async (e) => {
        e.preventDefault();
  
        // –°–Ω–∞—á–∞–ª–∞ —Å–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –±–∞–∑—É
        try {
          await saveMainRsvp();
        } catch (err) {
          console.error(err);
          alert("–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –æ—Ç–≤–µ—Ç. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑.");
          return;
        }
  
        // –ü–æ—Ç–æ–º —É–∂–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–ø–∞–ø—ã / –ª–æ–≥–∏–∫—É –ø–æ –¥–∞/–Ω–µ—Ç
        const selected = form.querySelector('input[name="go"]:checked')?.value;
  if (selected === "yes") {
    launchConfetti();      // üéâ –∑–∞–ø—É—Å–∫–∞–µ–º –∫–æ–Ω—Ñ–µ—Ç—Ç–∏
    showPopupSequence();   // –∑–∞—Ç–µ–º –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–ø–∞–ø—ã
  }

        if (selected === "no") {
          // –ù–∞ –≤—Å—è–∫–∏–π —Å–ª—É—á–∞–π —É–¥–∞–ª—è–µ–º –ø–æ–ø–∞–ø, –µ—Å–ª–∏ –≤–¥—Ä—É–≥ –µ—Å—Ç—å
          const ov = document.querySelector('.popup-overlay');
          if (ov) ov.remove();
        }
      });
  
      // --- –ø–ª–∞–≤–Ω—ã–π —Å–∫—Ä–æ–ª–ª –ø–æ –≤–µ—Ä—Ö–Ω–µ–º—É –º–µ–Ω—é ---
      const OFFSET = 140;
  
      function smoothScrollTo(el, offset = 0) {
        const current = window.pageYOffset || document.documentElement.scrollTop;
        const rectTop = el.getBoundingClientRect().top;
        let targetY = current + rectTop - offset;
  
        const maxY = document.documentElement.scrollHeight - window.innerHeight;
        if (targetY < 0) targetY = 0;
        if (targetY > maxY) targetY = maxY;
  
        window.scrollTo({ top: targetY, behavior: 'smooth' });
      }
  
      regLink.addEventListener('click', (e) => {
        e.preventDefault();
        smoothScrollTo(rsvpSection, OFFSET);
      });
  
      giftsLink.addEventListener('click', (e) => {
        e.preventDefault();
        smoothScrollTo(giftsSection, OFFSET);
      });
    });
  </script>  

<script>
  function launchConfetti() {
    const colors = ["#ff3b3b", "#ffd93b", "#ff7a3b", "#ffef3b", "#ff4f4f"]; // –∫–∏—Ç–∞–π—Å–∫–∞—è –ø–∞–ª–∏—Ç—Ä–∞

    const amount = 180; // –±–æ–ª—å—à–µ –∫–æ–Ω—Ñ–µ—Ç—Ç–∏

    for (let i = 0; i < amount; i++) {
        const confetti = document.createElement("div");
        confetti.classList.add("confetti-piece");

        // —Å–ª—É—á–∞–π–Ω—ã–π —Ä–∞–∑–º–µ—Ä
        const size = Math.random() * 10 + 6; 
        confetti.style.width = size + "px";
        confetti.style.height = (size * (0.4 + Math.random() * 0.4)) + "px";

        // —Å—Ç–∞—Ä—Ç–æ–≤–∞—è –ø–æ–∑–∏—Ü–∏—è –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö —à–∏—Ä–∏–Ω—ã —ç–∫—Ä–∞–Ω–∞
        confetti.style.left = Math.random() * 100 + "vw";

        // —Ä–∞–∑–Ω—ã–µ —É–≥–ª—ã
        const rotate = Math.random() * 360;
        confetti.style.transform = `rotate(${rotate}deg)`;

        // —Ü–≤–µ—Ç
        confetti.style.background = colors[Math.floor(Math.random() * colors.length)];

        // –∑–∞–¥–µ—Ä–∂–∫–∞ –ø–∞–¥–µ–Ω–∏—è (—á—Ç–æ–±—ã –Ω–µ –ø–∞–¥–∞–ª–∏ –æ–¥–Ω–æ–π –ª–∏–Ω–∏–µ–π)
        confetti.style.animationDelay = (Math.random() * 0.5) + "s";

        // —Ä–∞–∑–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å (–º–∞—Å—Å–∞)
        confetti.style.animationDuration = (0.9 + Math.random() * 0.5) + "s";


        document.body.appendChild(confetti);

        // —É–¥–∞–ª—è–µ–º
        setTimeout(() => confetti.remove(), 3000);
    }
}

  </script>




</body>
</html>
